<!DOCTYPE html>
<html lang="en-US">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>Python Automation</title>
</head>
<body>
    <a href="index.html">Home</a>
    <h1>Python Automation</h1>

    <h2>File Manipulation</h2>

    <h3>Path Joins</h3>
    <pre><code>
import os

os.path.join('usr', 'bin', 'spam') # 'usr\\bin\\spam'
    </code></pre>

    <h3>Working Directory</h3>
    <pre><code>
import os

os.getcwd() # Returns current working directory
os.chdir('/home/username') # Changes current working directory to given path
    </code></pre>

    <h3>Create Directory</h3>
    <pre><code>
import os

os.makedirs('/home/username/new_dir') # Creates new directory 'new_dir'
    </code></pre>

    <h3>Handling Paths</h3>
    <pre><code>
import os

os.path.abspath(path) # Returns absolute of given path
os.path.isabs(path) # Returns whether given path is absolute

os.path.relpath(path, start) # Returns relative path from start to path

os.path.dirname(path) # Returns string of everything BEFORE last slash in given path
os.path.basename(path) # Returns string of everything AFTER last slash in given path
os.path.split(path) # Returns tuple of dirname and basename: (os.path.dirname(path), os.path.basename(path))

path.split(os.path.sep) # Splits path along the path seperator to get list of path names
    </code></pre>

    <h3>Handling Directory Contents</h3>
    <pre><code>
import os

os.path.getsize(path) # Returns size in bytes of given file in path
os.listdir(path) # Returns a list of filename strings for each file at path
    </code></pre>

    <h3>Checking Path Validity</h3>
    <pre><code>
import os

os.path.exists(path) # Returns True if file of directory exists, False otherwise
os.path.isfile(path) # Returns True if path exists and is a file, False otherwise
os.path.isdir(path) # Returns True if path exists and is a directory, False otherwise
    </code></pre>

    <h3>Reading From Files</h3>
    <pre><code>
with open('filename.txt', 'r') as file:
    content = file.read()

with open('filename.txt', 'r') as file:
    content = file.readlines()
    </code></pre>

    <h3>Writing To Files</h3>
    <pre><code>
# Write mode will overwrite the contents of the file
with open('filename.txt', 'w') as file:
    file.write('content')

# Append mode will overwrite the contents of the file
with open('filename.txt', 'a') as file:
    file.write('content')
    </code></pre>

    <h3>Saving Variables</h3>
    <pre><code>
import shelve

with shelve.open('data') as shelf:
    shelf['key'] = 'value' # value may be any data type/structure

    list(shelf.keys()) # List keys in shelf
    list(shelf.values()) # List values in shelf
    </code></pre>

    <pre><code>
import pprint

array = []
with open('newfile.py', 'w') as file:
    # pprint.pformat pretty prints any data given so that it may be used in a new .py file
    file.write(f'newArray = {pprint.pformat(array)}\n')
    </code></pre>

    <h3>The shutil Module</h3>
    <pre><code>
import shutil

# Copies file at source path to directory at destination path
# If destination is a file, then the name of the copied file changes to that given in destination
shutil.copy(source, destination) 

# Copies files and subdirectories within source path directory to the destination path directory
shutil.copytree(source, destination)
    </code></pre>

    <pre><code>
import shutil

# Moves the file or directory path at source to path at destination
# If destination is a folder, then source is moved into the folder
# If destination is a file, then source is moved to the path and renamed to file name in destination
shutil.move(source, destination)
    </code></pre>

    <h3>Permantently Deleting Files and Folders</h3>
    <pre><code>
import os

os.unlink(path) # Deletes the file at path
os.rmdir(path) # Deletes the directory at path, the directory must be empty
os.rmtree(path) # Deletes the directory at path, including all files and sub-directories it contains
    </code></pre>
    

    <h3>Safe Deletes With send2trash Module</h3>
    <p>Must use <code>pip install send2trash</code> to add module as it's a third-party module.</p>
    <pre><code>
import send2trash

send2trash.send2trash(path) # Moves file or folder specified at path to trash or recycling bin
    </code></pre>

    <h3>Walking a Directory Tree</h3>
    <pre><code>
import os

# In each iteration through the loop, os.walk() returns:
#   A string of the current folder's name
#   A list of strings of the folders in the current folder
#   A list of strings of the files in the current folder
for folderName, subfolders, fileNames in os.walk(path):
    print(f'the current folder is {folderName}')

    for subfolder in subfolders:
        print(f'SUBFOLDER OF {folderName}: {subfolder}')

    for fileName in fileNames:
        print(f'FILE INSIDE {folderName}: {fileName}')
    
    print('')
    </code></pre>

    <h3>Reading ZIP Files</h3>
    <pre><code>
import zipfile

with zipfile.ZipFile(path) as file:
    file.namelist() # Returns list of strings for all files and folders contained in ZIP file

    for name in file.namelist():
        info = file.getinfo(name) # Returns info about file/folder given from namelist
        info.file_size # Size of the uncompressed file
        info.compress_size # Size of the compressed file
    </code></pre>

    <h3>Extracting From ZIP Files</h3>
    <pre><code>
import zipfile

with zipfile.ZipFile(path) as file:
    # Extracts all files in the zip to the current working directory
    # optionally, a path may be passed to the function to extract to that location
    file.extractall() 

with zipfile.ZipFile(path) as file:
    for name in file.namelist():
        # Extracts individual files/folders based on names from namelist
        # Returns absolute path of the extracted file/folder
        # optionally, a path may be passed to the function to extract to that location
        file.extract(name) 
    </code></pre>

    <h3>Creating and Adding to ZIP Files</h3>
    <pre><code>
import zipfile

# Open in write mode to override anything in the ZIP File or for creating a new file
with zipfile.ZipFile(path, 'w') as file: 
    # Writes file/folder at other_path to the ZIP file
    file.write(other_path, compress_type=zipfile.ZIP_DEFLATED)

# Open in append mode to add to an existing ZIP file
with zipfile.ZipFile(path, 'a') as file:
    # Writes file/folder at other_path to the ZIP file
    file.write(other_path, compress_type=zipfile.ZIP_DEFLATED)
    </code></pre>

    <h3>Opening Browser With webbrowser Module</h3>
    <pre><code>
import webbrowser

webbrowser.open(url)
    </code></pre>

    <h3>Downloading Files With requests Module</h3>
    <pre><code>

    </code></pre>

    <h3>Parsing HTML With BeautifulSoup Module</h3>
    <p>Must use <code>pip install beautifulsoup4</code> to add module as it's a third-party module.</p>
    <pre><code>

    </code></pre>

    <h3>Controlling Browser with Selenium Module</h3>
    <pre><code>

    </code></pre>
</body>
</html>